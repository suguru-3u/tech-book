## CSRFセキュリティ脆弱性クイズ

### 問題1：クロスサイト・リクエスト・フォージェリ（CSRF）攻撃が成立するために必要不可欠な、ウェブブラウザの動作は次のうちどれですか？
1.  ユーザーがウェブサイトにログインしている間、ブラウザがセッションクッキーを自動的にリクエストに含めること。
2.  ウェブサイトがユーザーの認証情報をブラウザのローカルストレージに保存すること。
3.  ブラウザがHTTPリクエストを送信する際に、Refererヘッダーを常に隠すこと。
4.  ウェブサイトが、ユーザーからのPOSTリクエストをGETリクエストに変換すること。

---

### 問題2：ウェブアプリケーションの「重要な処理」を実行する際に、CSRF攻撃を防ぐ最も効果的な対策はどれですか？
1.  ユーザーにメールで確認を求めること。
2.  ユーザーのブラウザがCookieを無効にすることを必須とすること。
3.  すべてのフォームにCSRFトークンを埋め込むこと。
4.  パスワードの長さを最低でも8文字以上に設定することを要求すること。

---

### 問題3：CSRF攻撃を防ぐための「Refererヘッダーチェック」が、万能な対策ではないのはなぜですか？
1.  Refererヘッダーは暗号化されているため、サーバーが読み取れないことがあるから。
2.  一部のブラウザ設定やプライバシー保護機能により、Refererヘッダーが送信されない場合があるから。
3.  Refererヘッダーは、攻撃者が簡単に偽装できるため。
4.  RefererヘッダーはHTTPリクエストではなく、HTTPSリクエストでのみ送信されるから。

---

### 問題4：CSRF攻撃とXSS攻撃の主な違いとして、最も適切なものは次のうちどれですか？
1.  CSRFはサーバー側の脆弱性を狙い、XSSはクライアント側の脆弱性を狙う。
2.  CSRFはスクリプトの実行を強制し、XSSは不正なリクエストの送信を強制する。
3.  CSRFはユーザーに代わって不正なリクエストを送信し、XSSは悪意のあるスクリプトをユーザーのブラウザで実行させる。
4.  CSRFはHTTPリクエストを利用し、XSSはHTTPSリクエストのみを利用する。

---

### 問題5：CSRF脆弱性があるウェブアプリケーションにおいて、攻撃者がユーザーのパスワード変更を強制する場合、そのリクエストに通常含まれるのは次のうちどれですか？
1.  攻撃者のセッションID
2.  被害者のIPアドレス
3.  被害者のセッションID
4.  攻撃者が設定した新しいパスワード

---

### 問題6：以下のうち、CSRF攻撃が成功する原因となるウェブの性質はどれですか？\
(1) フォームのaction属性はどのドメインのURLでも指定できる\
(2) クッキーに保存されたセッションIDは、対象サイトに自動的に送信される
1.  (1)のみ
2.  (2)のみ
3.  (1)と(2)の両方
4.  どちらでもない

---

### 問題7：パスワード変更のような「重要な処理」を実行する際に、ユーザーに再度パスワードの入力を求める対策は、なぜCSRF攻撃に有効なのですか？
1.  攻撃者がユーザーのパスワードを知らない限り、偽のリクエストにパスワードを含めることができないから。
2.  ユーザーがパスワードを入力することで、セッションクッキーが自動的に更新されるから。
3.  この対策は、ブラウザが勝手にパスワードを自動入力する機能を無効にするから。
4.  パスワードの再入力を求めることで、攻撃者がスクリプトを注入するのを防ぐから。

---

### 問題8：CSRF攻撃において、攻撃者が罠のサイトに仕込むHTMLコードの目的は次のうちどれですか？
1.  ユーザーのブラウザからセッションクッキーを盗み出すこと。
2.  ユーザーのブラウザに、正規サイトへの意図しないリクエストを強制的に送信させること。
3.  ユーザーのブラウザ上で不正なJavaScriptを実行し、キー入力を記録すること。
4.  正規サイトのWebサーバーをダウンさせること。

---

### 問題9：CSRF攻撃への「保険的対策」として、重要な処理の実行後にメール通知を送信する方法が推奨されるのはなぜですか？
1.  メール通知が攻撃者のPCに直接警告を送るから。
2.  この通知が、不正な処理を根本的に無効化するから。
3.  ユーザーが不正な処理に早期に気づき、被害を最小限に抑えることができるから。
4.  メール自体がCSRF攻撃を自動的に検知・ブロックする機能を持つから。

---

### 問題10：以下のシナリオのうち、CSRF攻撃が最も成功しやすいのはどれですか？
1.  ユーザーがウェブサイトにログインした後、セッションをログアウトし、ブラウザを閉じた場合。
2.  ウェブサイトが、リクエストごとにランダムなCSRFトークンを生成・検証している場合。
3.  ユーザーがウェブサイトにログインした状態のまま、攻撃者が用意した罠のサイトを