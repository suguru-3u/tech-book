### クイズの正解

---

### 1. CSRF攻撃が成立するために不可欠なブラウザの動作

**正解: ユーザーがウェブサイトにログインしている間、ブラウザがセッションクッキーを自動的にリクエストに含めること。**

* **解説**: CSRF攻撃は、ユーザーがすでに認証されている状態を悪用します。ブラウザが対象サイトへのリクエストに、認証情報であるセッションクッキーを自動的に付加する性質が、この攻撃の成立に不可欠です。

---

### 2. CSRF攻撃を防ぐ最も効果的な対策

**正解: すべてのフォームにCSRFトークンを埋め込むこと。**

* **解説**: CSRFトークンは、サーバーとクライアント間で共有される予測不可能な値です。リクエストが送信された際にこのトークンを検証することで、正規のフォームから送られたリクエストか、攻撃者による偽造リクエストかを確実に判断できます。

---

### 3. 「Refererヘッダーチェック」が万能な対策ではない理由

**正解: 一部のブラウザ設定やプライバシー保護機能により、Refererヘッダーが送信されない場合があるから。**

* **解説**: Refererヘッダーは、リクエストの送信元を示すものですが、ブラウザのプライバシー設定によっては送信されないことがあります。そのため、このチェックだけではCSRF攻撃を完全に防ぐことはできません。

---

### 4. CSRF攻撃とXSS攻撃の主な違い

**正解: CSRFはユーザーに代わって不正なリクエストを送信し、XSSは悪意のあるスクリプトをユーザーのブラウザで実行させる。**

* **解説**: CSRFは、ユーザーのブラウザに「リクエストの送信」を強制するのに対し、XSSは「スクリプトの実行」を強制します。目的と手段が根本的に異なります。

---

### 5. CSRF脆弱性があるウェブアプリケーションで、リクエストに含まれるもの

**正解: 被害者のセッションID**

* **解説**: 攻撃は、被害者がログインしている状態を悪用します。したがって、攻撃者が強制的に送信させるリクエストには、被害者のブラウザが自動的に付加した被害者自身のセッションIDが含まれます。

---

### 6. CSRFが成功する原因となるウェブの性質

**正解: (1)と(2)の両方**

* **解説**: フォームが外部ドメインにリクエストを送信できる性質（1）と、ブラウザがセッションクッキーを自動的に付加する性質（2）が組み合わさることで、CSRFは成立します。

---

### 7. パスワード再入力がCSRF攻撃に有効な理由

**正解: 攻撃者がユーザーのパスワードを知らない限り、偽のリクエストにパスワードを含めることができないから。**

* **解説**: パスワードの再入力を求めることで、攻撃者はそのリクエストに必要なパスワードを把握できなくなります。これにより、ユーザー本人による操作であることを確認できます。

---

### 8. 攻撃者が罠のサイトに仕込むHTMLコードの目的

**正解: ユーザーのブラウザに、正規サイトへの意図しないリクエストを強制的に送信させること。**

* **解説**: 攻撃者は、罠のサイトを介して、被害者のブラウザに正規サイトへの不正なリクエストを送信させることを目的とします。

---

### 9. メール通知が「保険的対策」として推奨される理由

**正解: ユーザーが不正な処理に早期に気づき、被害を最小限に抑えることができるから。**

* **解説**: メール通知は、攻撃そのものを防ぐものではなく、攻撃が成功した後にユーザーに異変を知らせることで、迅速な対処を促し、被害の拡大を防ぐためのものです。

---

### 10. CSRF攻撃が最も成功しやすいシナリオ

**正解: ユーザーがウェブサイトにログインした状態のまま、攻撃者が用意した罠のサイトを閲覧した場合。**

* **解説**: このシナリオがCSRF攻撃の最も典型的なパターンです。ログイン状態が維持されていることが、攻撃成功の前提条件となります。