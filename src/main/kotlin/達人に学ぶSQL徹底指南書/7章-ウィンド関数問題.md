
## 事前準備

-----

### 問題1：`Sales`テーブル

```sql

```

-----

### 問題2：`Shouhin`テーブル

```sql
CREATE TABLE Shouhin (
    shohin_id CHAR(4) PRIMARY KEY,
    shohin_mei VARCHAR(100),
    shohin_bunrui VARCHAR(100),
    hanbai_tanka INT
);

INSERT INTO Shouhin (shohin_id, shohin_mei, shohin_bunrui, hanbai_tanka) VALUES
('0001', 'Tシャツ', '衣服', 1000),
('0002', '穴あけパンチ', '事務用品', 500),
('0003', 'カッターシャツ', '衣服', 4000),
('0004', '包丁', 'キッチン用品', 3000),
('0005', '圧力鍋', 'キッチン用品', 6800),
('0006', 'フォーク', 'キッチン用品', 500),
('0007', 'おろしがね', 'キッチン用品', 880),
('0008', 'ボールペン', '事務用品', 100);
```

-----

### 問題3：`Reservations`テーブル

```sql
CREATE TABLE Reservations (
    reserver VARCHAR(100),
    start_date DATE,
    end_date DATE
);

INSERT INTO Reservations (reserver, start_date, end_date) VALUES
('木村', '2018-10-26', '2018-10-27'),
('荒木', '2018-10-28', '2018-10-31'),
('堀', '2018-10-31', '2018-11-01'),
('山本', '2018-11-03', '2018-11-04'),
('内田', '2018-11-03', '2018-11-05'),
('水谷', '2018-11-06', '2018-11-06');

```

---

### 問題1：前年との比較

以下の`Sales`テーブルには、年ごとの売上データが格納されています。

| year | sale |
|:---:|:---:|
| 1990 | 50 |
| 1991 | 51 |
| 1992 | 52 |
| 1993 | 52 |
| 1994 | 50 |
| 1995 | 50 |
| 1996 | 49 |
| 1997 | 55 |

`Sales`テーブルから、**各年の売上（`current_sale`）** と **前年の売上（`pre_sale`）** を取得するSQLを作成してください。

---

### 問題2：累計の計算

以下の`Shouhin`テーブルには、商品ごとの販売データが格納されています。

| shohin_id | shohin_mei | shohin_bunrui | hanbai_tanka |
|:---:|:---:|:---:|:---:|
| 0001 | Tシャツ | 衣服 | 1000 |
| 0002 | 穴あけパンチ | 事務用品 | 500 |
| 0003 | カッターシャツ | 衣服 | 4000 |
| 0004 | 包丁 | キッチン用品 | 3000 |
| 0005 | 圧力鍋 | キッチン用品 | 6800 |
| 0006 | フォーク | キッチン用品 | 500 |
| 0007 | おろしがね | キッチン用品 | 880 |
| 0008 | ボールペン | 事務用品 | 100 |

`Shouhin`テーブルから、**各商品の販売単価（`hanbai_tanka`）** と、**同じ分類（`shohin_bunrui`）の商品の平均単価（`avg_tanka`）** を取得するSQLを作成してください。

---

### 問題3：重複期間の検出

以下の`Reservations`テーブルには、宿泊客の予約データが格納されています。

| reserver | start_date | end_date |
|:---:|:---:|:---:|
| 木村 | 2018-10-26 | 2018-10-27 |
| 荒木 | 2018-10-28 | 2018-10-31 |
| 堀 | 2018-10-31 | 2018-11-01 |
| 山本 | 2018-11-03 | 2018-11-04 |
| 内田 | 2018-11-03 | 2018-11-05 |
| 水谷 | 2018-11-06 | 2018-11-06 |

`Reservations`テーブルから、**他の宿泊客の予約期間と重複している予約**を抽出するSQLを作成してください。ただし、期間の重複は以下の3つのパターンを考慮してください。

1.  自分の**開始日**が、他の予約期間内に含まれる。
2.  自分の**終了日**が、他の予約期間内に含まれる。
3.  自分の**開始日と終了日**が、他の予約期間内に含まれる。